#!/usr/bin/env sh
# pre-commit: зберегти git diff у SQLite через .tools/ctx.py

# Визначаємо Python
if [ -x "./.venv/Scripts/python.exe" ]; then
  PY="./.venv/Scripts/python.exe"
elif [ -x "./.venv/bin/python" ]; then
  PY="./.venv/bin/python"
else
  PY="python"
fi

# Запускаємо snapshot (тихо, але з коротким повідомленням)
$PY ./.tools/ctx.py snapshot --summary "pre-commit" >/dev/null 2>&1 || {
  echo "[pre-commit] WARN: ctx.py snapshot failed (продовжую коміт)"
}

exit 0
